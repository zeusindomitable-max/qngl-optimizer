{
 "cells": [
  {
   "cell_type": "markdown",
   "source": ["# QNGL Demo: Fit sin(Ï€x) with 2 Modules"]
  },
  {
   "cell_type": "code",
   "source": [
    "!pip install qngl-optimizer\n",
    "import torch, matplotlib.pyplot as plt\n",
    "from qngl import QNGLOptimizer\n",
    "\n",
    "alpha = torch.tensor([1.0+0j, 1.0+0j], requires_grad=True)\n",
    "theta = torch.tensor([1.0, 1.0], requires_grad=True)\n",
    "opt = QNGLOptimizer([alpha, theta], lr=0.1)\n",
    "\n",
    "x = torch.linspace(0,1,10)\n",
    "y = torch.sin(torch.pi * x)\n",
    "losses = []\n",
    "\n",
    "for i in range(200):\n",
    "    pred = alpha[0]*torch.sin(theta[0]*x) + alpha[1]*torch.cos(theta[1]*x)\n",
    "    loss = ((pred - y)**2).mean()\n",
    "    opt.zero_grad()\n",
    "    loss.backward()\n",
    "    opt.step()\n",
    "    losses.append(loss.item())\n",
    "\n",
    "plt.plot(losses)\n",
    "plt.yscale('log')\n",
    "plt.title('QNGL Training Curve')\n",
    "plt.show()"
   ]
  }
 ]
}
